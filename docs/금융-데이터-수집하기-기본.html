<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 금융 데이터 수집하기 (기본) | R을 이용한 퀀트 투자 포트폴리오 만들기(개정판)</title>
  <meta name="description" content="Chapter 5 금융 데이터 수집하기 (기본) | R을 이용한 퀀트 투자 포트폴리오 만들기(개정판)" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 금융 데이터 수집하기 (기본) | R을 이용한 퀀트 투자 포트폴리오 만들기(개정판)" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="hyunyulhenry/quant_cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 금융 데이터 수집하기 (기본) | R을 이용한 퀀트 투자 포트폴리오 만들기(개정판)" />
  
  
  

<meta name="author" content="이현열" />


<meta name="date" content="2021-11-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="크롤링-이해하기.html"/>
<link rel="next" href="금융-데이터-수집하기-심화.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-8.1.2/highcharts.js"></script>
<script src="libs/highcharts-8.1.2/highcharts-3d.js"></script>
<script src="libs/highcharts-8.1.2/highcharts-more.js"></script>
<script src="libs/highcharts-8.1.2/modules/stock.js"></script>
<script src="libs/highcharts-8.1.2/modules/map.js"></script>
<script src="libs/highcharts-8.1.2/modules/annotations.js"></script>
<script src="libs/highcharts-8.1.2/modules/data.js"></script>
<script src="libs/highcharts-8.1.2/modules/drilldown.js"></script>
<script src="libs/highcharts-8.1.2/modules/item-series.js"></script>
<script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script>
<script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-8.1.2/modules/exporting.js"></script>
<script src="libs/highcharts-8.1.2/modules/export-data.js"></script>
<script src="libs/highcharts-8.1.2/modules/funnel.js"></script>
<script src="libs/highcharts-8.1.2/modules/heatmap.js"></script>
<script src="libs/highcharts-8.1.2/modules/treemap.js"></script>
<script src="libs/highcharts-8.1.2/modules/sankey.js"></script>
<script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script>
<script src="libs/highcharts-8.1.2/modules/organization.js"></script>
<script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script>
<script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script>
<script src="libs/highcharts-8.1.2/modules/sunburst.js"></script>
<script src="libs/highcharts-8.1.2/modules/vector.js"></script>
<script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script>
<script src="libs/highcharts-8.1.2/modules/xrange.js"></script>
<script src="libs/highcharts-8.1.2/modules/tilemap.js"></script>
<script src="libs/highcharts-8.1.2/modules/venn.js"></script>
<script src="libs/highcharts-8.1.2/modules/gantt.js"></script>
<script src="libs/highcharts-8.1.2/modules/timeline.js"></script>
<script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-8.1.2/modules/bullet.js"></script>
<script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script>
<script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script>
<script src="libs/highcharts-8.1.2/modules/lollipop.js"></script>
<script src="libs/highcharts-8.1.2/modules/series-label.js"></script>
<script src="libs/highcharts-8.1.2/plugins/motion.js"></script>
<script src="libs/highcharts-8.1.2/custom/reset.js"></script>
<script src="libs/highcharts-8.1.2/modules/boost.js"></script>
<script src="libs/highchart-binding-0.8.2/highchart.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R을 이용한 퀀트 투자 포트폴리오 만들기</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#지은이-소개"><i class="fa fa-check"></i>지은이 소개</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#머리말"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#이-책의-구성"><i class="fa fa-check"></i>이 책의 구성</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#이-책에서-다루지-않은-주제"><i class="fa fa-check"></i>이 책에서 다루지 않은 주제</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#도움이-될-만한-자료들"><i class="fa fa-check"></i>도움이 될 만한 자료들</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#이-책의-지원-페이지"><i class="fa fa-check"></i>이 책의 지원 페이지</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#종목과-관련된-유의사항"><i class="fa fa-check"></i>종목과 관련된 유의사항</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#세션정보"><i class="fa fa-check"></i>세션정보</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html"><i class="fa fa-check"></i>R 기초 배우기</a>
<ul>
<li class="chapter" data-level="0.1" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#r과-r-스튜디오-설치하기"><i class="fa fa-check"></i><b>0.1</b> R과 R 스튜디오 설치하기</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#r-설치하기"><i class="fa fa-check"></i><b>0.1.1</b> R 설치하기</a></li>
<li class="chapter" data-level="0.1.2" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#r-스튜디오-설치하기"><i class="fa fa-check"></i><b>0.1.2</b> R 스튜디오 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#r-스튜디오-화면-구성"><i class="fa fa-check"></i><b>0.2</b> R 스튜디오 화면 구성</a></li>
<li class="chapter" data-level="0.3" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#r-스튜디오-설정하기"><i class="fa fa-check"></i><b>0.3</b> R 스튜디오 설정하기</a></li>
<li class="chapter" data-level="0.4" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#프로젝트-만들기"><i class="fa fa-check"></i><b>0.4</b> 프로젝트 만들기</a></li>
<li class="chapter" data-level="0.5" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#데이터-타입별-다루기"><i class="fa fa-check"></i><b>0.5</b> 데이터 타입별 다루기</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#숫자-형태"><i class="fa fa-check"></i><b>0.5.1</b> 숫자 형태</a></li>
<li class="chapter" data-level="0.5.2" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#문자열-형태"><i class="fa fa-check"></i><b>0.5.2</b> 문자열 형태</a></li>
<li class="chapter" data-level="0.5.3" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#날짜-형태"><i class="fa fa-check"></i><b>0.5.3</b> 날짜 형태</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#데이터-구조-다루기"><i class="fa fa-check"></i><b>0.6</b> 데이터 구조 다루기</a>
<ul>
<li class="chapter" data-level="0.6.1" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#벡터-다루기"><i class="fa fa-check"></i><b>0.6.1</b> 벡터 다루기</a></li>
<li class="chapter" data-level="0.6.2" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#리스트-다루기"><i class="fa fa-check"></i><b>0.6.2</b> 리스트 다루기</a></li>
<li class="chapter" data-level="0.6.3" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#데이터프레임-다루기"><i class="fa fa-check"></i><b>0.6.3</b> 데이터프레임 다루기</a></li>
<li class="chapter" data-level="0.6.4" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#결측치-처리하기"><i class="fa fa-check"></i><b>0.6.4</b> 결측치 처리하기</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#데이터-불러오기-및-내보내기"><i class="fa fa-check"></i><b>0.7</b> 데이터 불러오기 및 내보내기</a>
<ul>
<li class="chapter" data-level="0.7.1" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#워킹-디렉터리"><i class="fa fa-check"></i><b>0.7.1</b> 워킹 디렉터리</a></li>
<li class="chapter" data-level="0.7.2" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#csv-파일-불러오기-및-저장하기"><i class="fa fa-check"></i><b>0.7.2</b> csv 파일 불러오기 및 저장하기</a></li>
<li class="chapter" data-level="0.7.3" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#엑셀-파일-불러오기-및-저장하기"><i class="fa fa-check"></i><b>0.7.3</b> 엑셀 파일 불러오기 및 저장하기</a></li>
</ul></li>
<li class="chapter" data-level="0.8" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#효율성과-가독성-높이기"><i class="fa fa-check"></i><b>0.8</b> 효율성과 가독성 높이기</a>
<ul>
<li class="chapter" data-level="0.8.1" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#함수"><i class="fa fa-check"></i><b>0.8.1</b> 함수</a></li>
<li class="chapter" data-level="0.8.2" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#루프-구문"><i class="fa fa-check"></i><b>0.8.2</b> 루프 구문</a></li>
<li class="chapter" data-level="0.8.3" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#파이프-오퍼레이터"><i class="fa fa-check"></i><b>0.8.3</b> 파이프 오퍼레이터</a></li>
</ul></li>
<li class="chapter" data-level="0.9" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#데이터-구조-변형하기"><i class="fa fa-check"></i><b>0.9</b> 데이터 구조 변형하기</a>
<ul>
<li class="chapter" data-level="0.9.1" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#tidyr-패키지를-이용한-데이터-모양-바꾸기"><i class="fa fa-check"></i><b>0.9.1</b> <code>tidyr</code> 패키지를 이용한 데이터 모양 바꾸기</a></li>
<li class="chapter" data-level="0.9.2" data-path="r-기초-배우기.html"><a href="r-기초-배우기.html#dplyr-패키지를-이용한-데이터-변형하기"><i class="fa fa-check"></i><b>0.9.2</b> <code>dplyr</code> 패키지를 이용한 데이터 변형하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html"><i class="fa fa-check"></i><b>1</b> 퀀트 투자의 심장: 데이터와 프로그래밍</a>
<ul>
<li class="chapter" data-level="1.1" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#데이터-구하기"><i class="fa fa-check"></i><b>1.1</b> 데이터 구하기</a></li>
<li class="chapter" data-level="1.2" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#퀀트-투자와-프로그래밍"><i class="fa fa-check"></i><b>1.2</b> 퀀트 투자와 프로그래밍</a></li>
<li class="chapter" data-level="1.3" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#r-프로그램"><i class="fa fa-check"></i><b>1.3</b> R 프로그램</a></li>
<li class="chapter" data-level="1.4" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#퀀트-투자에-유용한-r-패키지"><i class="fa fa-check"></i><b>1.4</b> 퀀트 투자에 유용한 R 패키지</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html"><i class="fa fa-check"></i><b>2</b> 크롤링을 위한 기본 지식</a>
<ul>
<li class="chapter" data-level="2.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#인코딩의-이해와-r에서-utf-8-설정하기"><i class="fa fa-check"></i><b>2.1</b> 인코딩의 이해와 R에서 UTF-8 설정하기</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#인간과-컴퓨터-간-번역의-시작-ascii"><i class="fa fa-check"></i><b>2.1.1</b> 인간과 컴퓨터 간 번역의 시작, ASCII</a></li>
<li class="chapter" data-level="2.1.2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#한글-인코딩-방식의-종류"><i class="fa fa-check"></i><b>2.1.2</b> 한글 인코딩 방식의 종류</a></li>
<li class="chapter" data-level="2.1.3" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#r에서-utf-8-설정하기"><i class="fa fa-check"></i><b>2.1.3</b> R에서 UTF-8 설정하기</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#웹의-동작-방식"><i class="fa fa-check"></i><b>2.2</b> 웹의 동작 방식</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#http"><i class="fa fa-check"></i><b>2.2.1</b> HTTP</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#html과-css"><i class="fa fa-check"></i><b>2.3</b> HTML과 CSS</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#html-기본-구조"><i class="fa fa-check"></i><b>2.3.1</b> HTML 기본 구조</a></li>
<li class="chapter" data-level="2.3.2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#태그와-속성"><i class="fa fa-check"></i><b>2.3.2</b> 태그와 속성</a></li>
<li class="chapter" data-level="2.3.3" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#h-태그와-p-태그"><i class="fa fa-check"></i><b>2.3.3</b> h 태그와 p 태그</a></li>
<li class="chapter" data-level="2.3.4" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#리스트를-나타내는-ul-태그와-ol-태그"><i class="fa fa-check"></i><b>2.3.4</b> 리스트를 나타내는 ul 태그와 ol 태그</a></li>
<li class="chapter" data-level="2.3.5" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#table-태그"><i class="fa fa-check"></i><b>2.3.5</b> table 태그</a></li>
<li class="chapter" data-level="2.3.6" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#a-태그와-img-태그-및-속성"><i class="fa fa-check"></i><b>2.3.6</b> a 태그와 img 태그 및 속성</a></li>
<li class="chapter" data-level="2.3.7" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#div-태그"><i class="fa fa-check"></i><b>2.3.7</b> div 태그</a></li>
<li class="chapter" data-level="2.3.8" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#css"><i class="fa fa-check"></i><b>2.3.8</b> CSS</a></li>
<li class="chapter" data-level="2.3.9" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#클래스와-id"><i class="fa fa-check"></i><b>2.3.9</b> 클래스와 id</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#파이프-오퍼레이터-1"><i class="fa fa-check"></i><b>2.4</b> 파이프 오퍼레이터(<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="2.5" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#오류에-대한-예외처리"><i class="fa fa-check"></i><b>2.5</b> 오류에 대한 예외처리</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html"><i class="fa fa-check"></i><b>3</b> API를 이용한 데이터 수집</a>
<ul>
<li class="chapter" data-level="3.1" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#api를-이용한-quandl-데이터-다운로드"><i class="fa fa-check"></i><b>3.1</b> API를 이용한 Quandl 데이터 다운로드</a></li>
<li class="chapter" data-level="3.2" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#getsymbols-함수를-이용한-api-다운로드"><i class="fa fa-check"></i><b>3.2</b> <code>getSymbols()</code> 함수를 이용한 API 다운로드</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#주가-다운로드"><i class="fa fa-check"></i><b>3.2.1</b> 주가 다운로드</a></li>
<li class="chapter" data-level="3.2.2" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#국내-종목-주가-다운로드"><i class="fa fa-check"></i><b>3.2.2</b> 국내 종목 주가 다운로드</a></li>
<li class="chapter" data-level="3.2.3" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#fred-데이터-다운로드"><i class="fa fa-check"></i><b>3.2.3</b> FRED 데이터 다운로드</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html"><i class="fa fa-check"></i><b>4</b> 크롤링 이해하기</a>
<ul>
<li class="chapter" data-level="4.1" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#get과-post-방식-이해하기"><i class="fa fa-check"></i><b>4.1</b> GET과 POST 방식 이해하기</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#get-방식"><i class="fa fa-check"></i><b>4.1.1</b> GET 방식</a></li>
<li class="chapter" data-level="4.1.2" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#post-방식"><i class="fa fa-check"></i><b>4.1.2</b> POST 방식</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#크롤링-예제"><i class="fa fa-check"></i><b>4.2</b> 크롤링 예제</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#금융-속보-크롤링"><i class="fa fa-check"></i><b>4.2.1</b> 금융 속보 크롤링</a></li>
<li class="chapter" data-level="4.2.2" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#기업공시채널에서-오늘의-공시-불러오기"><i class="fa fa-check"></i><b>4.2.2</b> 기업공시채널에서 오늘의 공시 불러오기</a></li>
<li class="chapter" data-level="4.2.3" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#네이버-금융에서-주식티커-크롤링"><i class="fa fa-check"></i><b>4.2.3</b> 네이버 금융에서 주식티커 크롤링</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html"><i class="fa fa-check"></i><b>5</b> 금융 데이터 수집하기 (기본)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#한국거래소의-산업별-현황-및-개별지표-크롤링"><i class="fa fa-check"></i><b>5.1</b> 한국거래소의 산업별 현황 및 개별지표 크롤링</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#업종분류-현황-크롤링"><i class="fa fa-check"></i><b>5.1.1</b> 업종분류 현황 크롤링</a></li>
<li class="chapter" data-level="5.1.2" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#개별종목-지표-크롤링"><i class="fa fa-check"></i><b>5.1.2</b> 개별종목 지표 크롤링</a></li>
<li class="chapter" data-level="5.1.3" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#최근-영업일-기준-데이터-받기"><i class="fa fa-check"></i><b>5.1.3</b> 최근 영업일 기준 데이터 받기</a></li>
<li class="chapter" data-level="5.1.4" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#거래소-데이터-정리하기"><i class="fa fa-check"></i><b>5.1.4</b> 거래소 데이터 정리하기</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#wics-기준-섹터정보-크롤링"><i class="fa fa-check"></i><b>5.2</b> WICS 기준 섹터정보 크롤링</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html"><i class="fa fa-check"></i><b>6</b> 금융 데이터 수집하기 (심화)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#수정주가-크롤링"><i class="fa fa-check"></i><b>6.1</b> 수정주가 크롤링</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#개별종목-주가-크롤링"><i class="fa fa-check"></i><b>6.1.1</b> 개별종목 주가 크롤링</a></li>
<li class="chapter" data-level="6.1.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#전-종목-주가-크롤링"><i class="fa fa-check"></i><b>6.1.2</b> 전 종목 주가 크롤링</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#재무제표-및-가치지표-크롤링"><i class="fa fa-check"></i><b>6.2</b> 재무제표 및 가치지표 크롤링</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#재무제표-다운로드"><i class="fa fa-check"></i><b>6.2.1</b> 재무제표 다운로드</a></li>
<li class="chapter" data-level="6.2.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#가치지표-계산하기"><i class="fa fa-check"></i><b>6.2.2</b> 가치지표 계산하기</a></li>
<li class="chapter" data-level="6.2.3" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#전-종목-재무제표-및-가치지표-다운로드"><i class="fa fa-check"></i><b>6.2.3</b> 전 종목 재무제표 및 가치지표 다운로드</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#dart의-open-api를-이용한-데이터-수집하기"><i class="fa fa-check"></i><b>6.3</b> DART의 Open API를 이용한 데이터 수집하기</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#api-key발급-및-추가하기"><i class="fa fa-check"></i><b>6.3.1</b> API Key발급 및 추가하기</a></li>
<li class="chapter" data-level="6.3.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#고유번호-다운로드"><i class="fa fa-check"></i><b>6.3.2</b> 고유번호 다운로드</a></li>
<li class="chapter" data-level="6.3.3" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#공시검색"><i class="fa fa-check"></i><b>6.3.3</b> 공시검색</a></li>
<li class="chapter" data-level="6.3.4" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#사업보고서-주요-정보"><i class="fa fa-check"></i><b>6.3.4</b> 사업보고서 주요 정보</a></li>
<li class="chapter" data-level="6.3.5" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#상장기업-재무정보"><i class="fa fa-check"></i><b>6.3.5</b> 상장기업 재무정보</a></li>
<li class="chapter" data-level="6.3.6" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#단일회사-전체-재무제표"><i class="fa fa-check"></i><b>6.3.6</b> 단일회사 전체 재무제표</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html"><i class="fa fa-check"></i><b>7</b> 데이터 정리하기</a>
<ul>
<li class="chapter" data-level="7.1" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html#주가-정리하기"><i class="fa fa-check"></i><b>7.1</b> 주가 정리하기</a></li>
<li class="chapter" data-level="7.2" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html#재무제표-정리하기"><i class="fa fa-check"></i><b>7.2</b> 재무제표 정리하기</a></li>
<li class="chapter" data-level="7.3" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html#가치지표-정리하기"><i class="fa fa-check"></i><b>7.3</b> 가치지표 정리하기</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html"><i class="fa fa-check"></i><b>8</b> 데이터 분석 및 시각화하기</a>
<ul>
<li class="chapter" data-level="8.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#종목정보-데이터-분석"><i class="fa fa-check"></i><b>8.1</b> 종목정보 데이터 분석</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#join-데이터-합치기-1"><i class="fa fa-check"></i><b>8.1.1</b> <code>*_join</code>: 데이터 합치기</a></li>
<li class="chapter" data-level="8.1.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#glimpse-데이터-구조-확인하기"><i class="fa fa-check"></i><b>8.1.2</b> <code>glimpse()</code>: 데이터 구조 확인하기</a></li>
<li class="chapter" data-level="8.1.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#rename-열-이름-바꾸기"><i class="fa fa-check"></i><b>8.1.3</b> <code>rename()</code>: 열 이름 바꾸기</a></li>
<li class="chapter" data-level="8.1.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#distinct-고유한-값-확인"><i class="fa fa-check"></i><b>8.1.4</b> distinct(): 고유한 값 확인</a></li>
<li class="chapter" data-level="8.1.5" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#select-원하는-열만-선택"><i class="fa fa-check"></i><b>8.1.5</b> <code>select()</code>: 원하는 열만 선택</a></li>
<li class="chapter" data-level="8.1.6" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#mutate-열-생성-및-데이터-변형"><i class="fa fa-check"></i><b>8.1.6</b> <code>mutate()</code>: 열 생성 및 데이터 변형</a></li>
<li class="chapter" data-level="8.1.7" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#filter-조건을-충족하는-행-선택"><i class="fa fa-check"></i><b>8.1.7</b> <code>filter()</code>: 조건을 충족하는 행 선택</a></li>
<li class="chapter" data-level="8.1.8" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#summarize-요약-통곗값-계산"><i class="fa fa-check"></i><b>8.1.8</b> <code>summarize()</code>: 요약 통곗값 계산</a></li>
<li class="chapter" data-level="8.1.9" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#arrange-데이터-정렬"><i class="fa fa-check"></i><b>8.1.9</b> <code>arrange()</code>: 데이터 정렬</a></li>
<li class="chapter" data-level="8.1.10" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#row_number-순위-계산"><i class="fa fa-check"></i><b>8.1.10</b> <code>row_number()</code>: 순위 계산</a></li>
<li class="chapter" data-level="8.1.11" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#ntile-분위수-계산"><i class="fa fa-check"></i><b>8.1.11</b> <code>ntile()</code>: 분위수 계산</a></li>
<li class="chapter" data-level="8.1.12" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#group_by-그룹별로-데이터를-묶기"><i class="fa fa-check"></i><b>8.1.12</b> <code>group_by()</code>: 그룹별로 데이터를 묶기</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#ggplot-기초"><i class="fa fa-check"></i><b>8.2</b> <code>ggplot()</code> 기초</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#diamonds-데이터셋"><i class="fa fa-check"></i><b>8.2.1</b> diamonds 데이터셋</a></li>
<li class="chapter" data-level="8.2.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#data-aesthetics-geometrics"><i class="fa fa-check"></i><b>8.2.2</b> Data, Aesthetics, Geometrics</a></li>
<li class="chapter" data-level="8.2.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#facets"><i class="fa fa-check"></i><b>8.2.3</b> Facets</a></li>
<li class="chapter" data-level="8.2.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#statistics"><i class="fa fa-check"></i><b>8.2.4</b> Statistics</a></li>
<li class="chapter" data-level="8.2.5" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#coordinates"><i class="fa fa-check"></i><b>8.2.5</b> Coordinates</a></li>
<li class="chapter" data-level="8.2.6" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#theme"><i class="fa fa-check"></i><b>8.2.6</b> Theme</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#종목정보-시각화"><i class="fa fa-check"></i><b>8.3</b> 종목정보 시각화</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_point-산점도-나타내기"><i class="fa fa-check"></i><b>8.3.1</b> <code>geom_point()</code>: 산점도 나타내기</a></li>
<li class="chapter" data-level="8.3.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_histogram-히스토그램-나타내기"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_histogram()</code>: 히스토그램 나타내기</a></li>
<li class="chapter" data-level="8.3.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_boxplot-박스-플롯-나타내기"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_boxplot()</code>: 박스 플롯 나타내기</a></li>
<li class="chapter" data-level="8.3.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#dplyr과-ggplot을-연결하여-사용하기"><i class="fa fa-check"></i><b>8.3.4</b> <code>dplyr</code>과 <code>ggplot</code>을 연결하여 사용하기</a></li>
<li class="chapter" data-level="8.3.5" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_bar-막대-그래프-나타내기"><i class="fa fa-check"></i><b>8.3.5</b> <code>geom_bar()</code>: 막대 그래프 나타내기</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#주가-및-수익률-시각화"><i class="fa fa-check"></i><b>8.4</b> 주가 및 수익률 시각화</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#주가-그래프-나타내기"><i class="fa fa-check"></i><b>8.4.1</b> 주가 그래프 나타내기</a></li>
<li class="chapter" data-level="8.4.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#인터랙티브-그래프-나타내기"><i class="fa fa-check"></i><b>8.4.2</b> 인터랙티브 그래프 나타내기</a></li>
<li class="chapter" data-level="8.4.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#연도별-수익률-나타내기"><i class="fa fa-check"></i><b>8.4.3</b> 연도별 수익률 나타내기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html"><i class="fa fa-check"></i><b>9</b> 퀀트 전략을 이용한 종목선정 (기본)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#베타-이해하기"><i class="fa fa-check"></i><b>9.1</b> 베타 이해하기</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#베타-계산하기"><i class="fa fa-check"></i><b>9.1.1</b> 베타 계산하기</a></li>
<li class="chapter" data-level="9.1.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#베타-시각화"><i class="fa fa-check"></i><b>9.1.2</b> 베타 시각화</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#저변동성-전략"><i class="fa fa-check"></i><b>9.2</b> 저변동성 전략</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#저변동성-포트폴리오-구하기-일간-기준"><i class="fa fa-check"></i><b>9.2.1</b> 저변동성 포트폴리오 구하기: 일간 기준</a></li>
<li class="chapter" data-level="9.2.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#저변동성-포트폴리오-구하기-주간-기준"><i class="fa fa-check"></i><b>9.2.2</b> 저변동성 포트폴리오 구하기: 주간 기준</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#모멘텀-전략"><i class="fa fa-check"></i><b>9.3</b> 모멘텀 전략</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#모멘텀-포트폴리오-구하기-12개월-모멘텀"><i class="fa fa-check"></i><b>9.3.1</b> 모멘텀 포트폴리오 구하기: 12개월 모멘텀</a></li>
<li class="chapter" data-level="9.3.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#모멘텀-포트폴리오-구하기-위험조정-수익률"><i class="fa fa-check"></i><b>9.3.2</b> 모멘텀 포트폴리오 구하기: 위험조정 수익률</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#밸류-전략"><i class="fa fa-check"></i><b>9.4</b> 밸류 전략</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#밸류-포트폴리오-구하기-저pbr"><i class="fa fa-check"></i><b>9.4.1</b> 밸류 포트폴리오 구하기: 저PBR</a></li>
<li class="chapter" data-level="9.4.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#각-지표-결합하기"><i class="fa fa-check"></i><b>9.4.2</b> 각 지표 결합하기</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#퀄리티-전략"><i class="fa fa-check"></i><b>9.5</b> 퀄리티 전략</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#f-score"><i class="fa fa-check"></i><b>9.5.1</b> F-Score</a></li>
<li class="chapter" data-level="9.5.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#각-지표를-결합하기"><i class="fa fa-check"></i><b>9.5.2</b> 각 지표를 결합하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html"><i class="fa fa-check"></i><b>10</b> 퀀트 전략을 이용한 종목선정 (심화)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#섹터-중립-포트폴리오"><i class="fa fa-check"></i><b>10.1</b> 섹터 중립 포트폴리오</a></li>
<li class="chapter" data-level="10.2" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#마법공식"><i class="fa fa-check"></i><b>10.2</b> 마법공식</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#퀄리티와-밸류-간의-관계"><i class="fa fa-check"></i><b>10.2.1</b> 퀄리티와 밸류 간의 관계</a></li>
<li class="chapter" data-level="10.2.2" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#마법공식-이해하기"><i class="fa fa-check"></i><b>10.2.2</b> 마법공식 이해하기</a></li>
<li class="chapter" data-level="10.2.3" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#마법공식-구성하기"><i class="fa fa-check"></i><b>10.2.3</b> 마법공식 구성하기</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#이상치-데이터-제거-및-팩터의-결합"><i class="fa fa-check"></i><b>10.3</b> 이상치 데이터 제거 및 팩터의 결합</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#트림trim-이상치-데이터-삭제"><i class="fa fa-check"></i><b>10.3.1</b> 트림(Trim): 이상치 데이터 삭제</a></li>
<li class="chapter" data-level="10.3.2" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#윈저라이징winsorizing-이상치-데이터-대체"><i class="fa fa-check"></i><b>10.3.2</b> 윈저라이징(Winsorizing): 이상치 데이터 대체</a></li>
<li class="chapter" data-level="10.3.3" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#팩터의-결합-방법"><i class="fa fa-check"></i><b>10.3.3</b> 팩터의 결합 방법</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#멀티팩터-포트폴리오"><i class="fa fa-check"></i><b>10.4</b> 멀티팩터 포트폴리오</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html"><i class="fa fa-check"></i><b>11</b> 포트폴리오 구성</a>
<ul>
<li class="chapter" data-level="11.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최소분산-포트폴리오"><i class="fa fa-check"></i><b>11.1</b> 최소분산 포트폴리오</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#slsqp-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.1.1</b> <code>slsqp()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.1.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#solve.qp-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.1.2</b> <code>solve.QP()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.1.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#optimalportfolio-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.1.3</b> <code>optimalPortfolio()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.1.4" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#결괏값들의-비교"><i class="fa fa-check"></i><b>11.1.4</b> 결괏값들의 비교</a></li>
<li class="chapter" data-level="11.1.5" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최소-및-최대-투자비중-제약조건"><i class="fa fa-check"></i><b>11.1.5</b> 최소 및 최대 투자비중 제약조건</a></li>
<li class="chapter" data-level="11.1.6" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#각-자산별-제약조건의-추가"><i class="fa fa-check"></i><b>11.1.6</b> 각 자산별 제약조건의 추가</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최대분산효과-포트폴리오"><i class="fa fa-check"></i><b>11.2</b> 최대분산효과 포트폴리오</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#solve.qp-함수를-이용한-최적화-1"><i class="fa fa-check"></i><b>11.2.1</b> <code>solve.QP()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.2.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#optimalportfolio-함수를-이용한-최적화-1"><i class="fa fa-check"></i><b>11.2.2</b> <code>optimalPortfolio()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.2.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최소-및-최대-투자비중-제약조건-1"><i class="fa fa-check"></i><b>11.2.3</b> 최소 및 최대 투자비중 제약조건</a></li>
<li class="chapter" data-level="11.2.4" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#각-자산-별-제약조건의-추가"><i class="fa fa-check"></i><b>11.2.4</b> 각 자산 별 제약조건의 추가</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#위험균형-포트폴리오"><i class="fa fa-check"></i><b>11.3</b> 위험균형 포트폴리오</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#주식-60와-채권-40-포트폴리오의-위험기여도"><i class="fa fa-check"></i><b>11.3.1</b> 주식 60%와 채권 40% 포트폴리오의 위험기여도</a></li>
<li class="chapter" data-level="11.3.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#rp-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.3.2</b> <code>rp()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.3.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#위험예산-포트폴리오"><i class="fa fa-check"></i><b>11.3.3</b> 위험예산 포트폴리오</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#인덱스-포트폴리오-구성하기"><i class="fa fa-check"></i><b>11.4</b> 인덱스 포트폴리오 구성하기</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#시가총액비중-계산하기"><i class="fa fa-check"></i><b>11.4.1</b> 시가총액비중 계산하기</a></li>
<li class="chapter" data-level="11.4.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#인덱스-포트폴리오-복제하기"><i class="fa fa-check"></i><b>11.4.2</b> 인덱스 포트폴리오 복제하기</a></li>
<li class="chapter" data-level="11.4.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#팩터를-이용한-인핸스드-포트폴리오-구성하기"><i class="fa fa-check"></i><b>11.4.3</b> 팩터를 이용한 인핸스드 포트폴리오 구성하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html"><i class="fa fa-check"></i><b>12</b> 포트폴리오 백테스트</a>
<ul>
<li class="chapter" data-level="12.1" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#return.portfolio-함수"><i class="fa fa-check"></i><b>12.1</b> <code>Return.Portfolio()</code> 함수</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#인자-목록-살펴보기"><i class="fa fa-check"></i><b>12.1.1</b> 인자 목록 살펴보기</a></li>
<li class="chapter" data-level="12.1.2" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#출력값-살펴보기"><i class="fa fa-check"></i><b>12.1.2</b> 출력값 살펴보기</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#전통적인-60대-40-포트폴리오-백테스트"><i class="fa fa-check"></i><b>12.2</b> 전통적인 60대 40 포트폴리오 백테스트</a></li>
<li class="chapter" data-level="12.3" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#시점-선택-전략-백테스트"><i class="fa fa-check"></i><b>12.3</b> 시점 선택 전략 백테스트</a></li>
<li class="chapter" data-level="12.4" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#동적-자산배분-백테스트"><i class="fa fa-check"></i><b>12.4</b> 동적 자산배분 백테스트</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html"><i class="fa fa-check"></i><b>13</b> 성과 및 위험 평가</a>
<ul>
<li class="chapter" data-level="13.1" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#결과-측정-지표"><i class="fa fa-check"></i><b>13.1</b> 결과 측정 지표</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#수익률-및-변동성"><i class="fa fa-check"></i><b>13.1.1</b> 수익률 및 변동성</a></li>
<li class="chapter" data-level="13.1.2" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#낙폭과-최대낙폭"><i class="fa fa-check"></i><b>13.1.2</b> 낙폭과 최대낙폭</a></li>
<li class="chapter" data-level="13.1.3" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#연도별-수익률"><i class="fa fa-check"></i><b>13.1.3</b> 연도별 수익률</a></li>
<li class="chapter" data-level="13.1.4" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#승률-및-롤링-윈도우-값"><i class="fa fa-check"></i><b>13.1.4</b> 승률 및 롤링 윈도우 값</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#팩터-회귀분석-및-테이블로-나타내기"><i class="fa fa-check"></i><b>13.2</b> 팩터 회귀분석 및 테이블로 나타내기</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://www.yes24.com/Product/Goods/97163849" target="blank">책 구입하러 가기</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R을 이용한 퀀트 투자 포트폴리오 만들기(개정판)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="금융-데이터-수집하기-기본" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> 금융 데이터 수집하기 (기본)</h1>
<p>API와 크롤링을 이용한다면 비용을 지불하지 않고 얼마든지 금융 데이터를 수집할 수있습니다. 이 CHAPTER에서는 금융 데이터를 받기 위해 필요한 주식티커를 구하는 방법과 섹터별 구성종목을 크롤링하는 방법을 알아보겠습니다.</p>
<div id="한국거래소의-산업별-현황-및-개별지표-크롤링" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> 한국거래소의 산업별 현황 및 개별지표 크롤링</h2>
<p>앞 CHAPTER의 예제를 통해 네이버 금융에서 주식티커를 크롤링하는 방법을 살펴보았습니다. 그러나 이 방법은 지나치게 복잡하고 시간이 오래 걸립니다. 반면 한국거래소에서 제공하는 업종분류 현황과 개별종목 지표 데이터를 이용하면 훨씬 간단하게 주식티커 데이터를 수집할 수 있습니다.</p>
<ul>
<li>KRX 정보데이터시스템 <a href="http://data.krx.co.kr/" class="uri">http://data.krx.co.kr/</a> 에서 [기본통계 → 주식 → 세부안내] 부분</li>
<li>[12025] 업종분류 현황</li>
<li>[12021] 개별종목</li>
</ul>
<p>해당 데이터들을 크롤링이 아닌 [Excel] 버튼을 클릭해 엑셀 파일로 받을 수도 있습니다. 그러나 매번 엑셀 파일을 다운로드하고 이를 R로 불러오는 작업은 상당히 비효율적이며, 크롤링을 이용한다면 해당 데이터를 R로 직접 불러올 수 있습니다.</p>
<div id="업종분류-현황-크롤링" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> 업종분류 현황 크롤링</h3>
<p>먼저 업종분류 현황에 해당하는 페이지에 접속한 후 개발자 도구 화면을 열고 [다운로드] 버튼을 클릭한 후 [CSV]를 누릅니다. [Network] 탭에는 generate.cmd와 download.cmd 두 가지 항목이 있습니다. 거래소에서 엑셀 데이터를 받는 과정은 다음과 같습니다.</p>
<ol style="list-style-type: decimal">
<li><p><a href="http://data.krx.co.kr/comm/fileDn/download_excel/download.cmd" class="uri">http://data.krx.co.kr/comm/fileDn/download_excel/download.cmd</a> 에 원하는 항목을 쿼리로 발송하면 해당 쿼리에 해당하는 OTP(generate.cmd)를 받게 됩니다.</p></li>
<li><p>부여받은 OTP를 <strong><a href="http://data.krx.co.kr/" class="uri">http://data.krx.co.kr/</a></strong>에 제출하면 이에 해당하는 데이터(download.cmd)를 다운로드하게 됩니다.</p></li>
</ol>
<p>먼저 1번 단계를 살펴보겠습니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-254"></span>
<img src="images/crawl_practice_krx_sector.png" alt="OTP 생성 부분" width="100%" />
<p class="caption">
그림 5.1: OTP 생성 부분
</p>
</div>
<p>General 항목의 Request URL의 앞부분이 원하는 항목을 제출할 주소입니다. Form Data에는 우리가 원하는 항목들이 적혀 있습니다. 이를 통해 POST 방식으로 데이터를 요청함을 알 수 있습니다.</p>
<p>다음으로 2번 단계를 살펴보겠습니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-255"></span>
<img src="images/crawl_practice_krx_sector2.png" alt="OTP 제출 부분" width="100%" />
<p class="caption">
그림 5.2: OTP 제출 부분
</p>
</div>
<p>General 항목의 Request URL은 OTP를 제출할 주소입니다. Form Data의 OTP는 1번 단계에서 부여받은 OTP에 해당합니다. 이 역시 POST 방식으로 데이터를 요청합니다.</p>
<p>위 과정을 코드로 나타내면 다음과 같습니다.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="금융-데이터-수집하기-기본.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb413-2"><a href="금융-데이터-수집하기-기본.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb413-3"><a href="금융-데이터-수집하기-기본.html#cb413-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb413-4"><a href="금융-데이터-수집하기-기본.html#cb413-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-5"><a href="금융-데이터-수집하기-기본.html#cb413-5" aria-hidden="true" tabindex="-1"></a>gen_otp_url <span class="ot">=</span></span>
<span id="cb413-6"><a href="금융-데이터-수집하기-기본.html#cb413-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/GenerateOTP/generate.cmd&#39;</span></span>
<span id="cb413-7"><a href="금융-데이터-수집하기-기본.html#cb413-7" aria-hidden="true" tabindex="-1"></a>gen_otp_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb413-8"><a href="금융-데이터-수집하기-기본.html#cb413-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mktId =</span> <span class="st">&#39;STK&#39;</span>,</span>
<span id="cb413-9"><a href="금융-데이터-수집하기-기본.html#cb413-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">trdDd =</span> <span class="st">&#39;20210108&#39;</span>,</span>
<span id="cb413-10"><a href="금융-데이터-수집하기-기본.html#cb413-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">money =</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb413-11"><a href="금융-데이터-수집하기-기본.html#cb413-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">csvxls_isNo =</span> <span class="st">&#39;false&#39;</span>,</span>
<span id="cb413-12"><a href="금융-데이터-수집하기-기본.html#cb413-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;fileDown&#39;</span>,</span>
<span id="cb413-13"><a href="금융-데이터-수집하기-기본.html#cb413-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&#39;dbms/MDC/STAT/standard/MDCSTAT03901&#39;</span></span>
<span id="cb413-14"><a href="금융-데이터-수집하기-기본.html#cb413-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb413-15"><a href="금융-데이터-수집하기-기본.html#cb413-15" aria-hidden="true" tabindex="-1"></a>otp <span class="ot">=</span> <span class="fu">POST</span>(gen_otp_url, <span class="at">query =</span> gen_otp_data) <span class="sc">%&gt;%</span></span>
<span id="cb413-16"><a href="금융-데이터-수집하기-기본.html#cb413-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>() <span class="sc">%&gt;%</span></span>
<span id="cb413-17"><a href="금융-데이터-수집하기-기본.html#cb413-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>gen_otp_url에 원하는 항목을 제출할 URL을 입력합니다.</li>
<li>개발자 도구 화면에 나타는 쿼리 내용들을 리스트 형태로 입력합니다. 이 중 mktId의 STK는 코스피에 해당하는 내용이며, 코스닥 데이터를 받고자 할 경우 KSQ를 입력해야 합니다.</li>
<li><code>POST()</code> 함수를 통해 해당 URL에 쿼리를 전송하면 이에 해당하는 데이터를 받게 됩니다.</li>
<li><code>read_html()</code>함수를 통해 HTML 내용을 읽어옵니다.</li>
<li><code>html_text()</code> 함수는 HTML 내에서 텍스트에 해당하는 부분만을 추출합니다. 이를 통해 OTP 값만 추출하게 됩니다.</li>
</ol>
<p>위의 과정을 거쳐 생성된 OTP를 제출하면, 우리가 원하는 데이터를 다운로드할 수 있습니다.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="금융-데이터-수집하기-기본.html#cb414-1" aria-hidden="true" tabindex="-1"></a>down_url <span class="ot">=</span> <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/download_csv/download.cmd&#39;</span></span>
<span id="cb414-2"><a href="금융-데이터-수집하기-기본.html#cb414-2" aria-hidden="true" tabindex="-1"></a>down_sector_KS <span class="ot">=</span> <span class="fu">POST</span>(down_url, <span class="at">query =</span> <span class="fu">list</span>(<span class="at">code =</span> otp),</span>
<span id="cb414-3"><a href="금융-데이터-수집하기-기본.html#cb414-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">add_headers</span>(<span class="at">referer =</span> gen_otp_url)) <span class="sc">%&gt;%</span></span>
<span id="cb414-4"><a href="금융-데이터-수집하기-기본.html#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb414-5"><a href="금융-데이터-수집하기-기본.html#cb414-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb414-6"><a href="금융-데이터-수집하기-기본.html#cb414-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>()</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>OTP를 제출할 URL을 down_url에 입력합니다.</li>
<li><code>POST()</code> 함수를 통해 위에서 부여받은 OTP 코드를 해당 URL에 제출합니다.</li>
<li><code>add_headers()</code> 구문을 통해 리퍼러(referer)를 추가해야 합니다. 리퍼러란 링크를 통해서 각각의 웹사이트로 방문할 때 남는 흔적입니다. 거래소 데이터를 다운로드하는 과정을 살펴보면 첫 번째 URL에서 OTP를 부여받고, 이를 다시 두번째 URL에 제출했습니다. 그런데 이러한 과정의 흔적이 없이 OTP를 바로 두번째 URL에 제출하면 서버는 이를 로봇으로 인식해 데이터를 반환하지 않습니다. 따라서 <code>add_headers()</code> 함수를 통해 우리가 거쳐온 과정을 흔적으로 남겨
야 데이터를 반환하게 되며 첫 번째 URL을 리퍼러로 지정해줍니다.</li>
<li><code>read_html()</code>과 <code>html_text()</code> 함수를 통해 텍스트 데이터만 추출합니다. EUC-KR로 인코딩이 되어 있으므로 <code>read_html()</code> 내에 이를 입력해줍니다.</li>
<li><code>read_csv()</code> 함수는 csv 형태의 데이터를 불러옵니다.</li>
</ol>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="금융-데이터-수집하기-기본.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(down_sector_KS)</span></code></pre></div>
<pre><code>## # A tibble: 917 x 8
##    종목코드 종목명      시장구분 업종명     종가  대비 등락률      시가총액
##    &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
##  1 095570   AJ네트웍스  KOSPI    서비스업   4540  -155  -3.3   212573219300
##  2 006840   AK홀딩스    KOSPI    기타금융  25350   150   0.6   335825671350
##  3 027410   BGF         KOSPI    기타금융   4905   -25  -0.51  469490859855
##  4 282330   BGF리테일   KOSPI    유통업   141000  4500   3.3  2437030746000
##  5 138930   BNK금융지주 KOSPI    기타금융   5780     0   0    1883905721880
##  6 001460   BYC         KOSPI    섬유의복 324500 10500   3.34  202687567500
##  7 001465   BYC우       KOSPI    섬유의복 157500 10000   6.78   33923137500
##  8 001040   CJ          KOSPI    기타금융 102500  7600   8.01 2990642295000
##  9 079160   CJ CGV      KOSPI    서비스업  26150   300   1.16  917865000000
## 10 00104K   CJ4우(전환) KOSPI    기타금융  81400  5300   6.96  344038076800
## # ... with 907 more rows</code></pre>
<p>위 과정을 통해 down_sector 변수에는 산업별 현황 데이터가 저장되었습니다. 코스닥 시장의 데이터도 다운로드 받도록 하겠습니다.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="금융-데이터-수집하기-기본.html#cb417-1" aria-hidden="true" tabindex="-1"></a>gen_otp_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb417-2"><a href="금융-데이터-수집하기-기본.html#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mktId =</span> <span class="st">&#39;KSQ&#39;</span>, <span class="co"># 코스닥으로 변경</span></span>
<span id="cb417-3"><a href="금융-데이터-수집하기-기본.html#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">trdDd =</span> <span class="st">&#39;20210108&#39;</span>,</span>
<span id="cb417-4"><a href="금융-데이터-수집하기-기본.html#cb417-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">money =</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb417-5"><a href="금융-데이터-수집하기-기본.html#cb417-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">csvxls_isNo =</span> <span class="st">&#39;false&#39;</span>,</span>
<span id="cb417-6"><a href="금융-데이터-수집하기-기본.html#cb417-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;fileDown&#39;</span>,</span>
<span id="cb417-7"><a href="금융-데이터-수집하기-기본.html#cb417-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&#39;dbms/MDC/STAT/standard/MDCSTAT03901&#39;</span></span>
<span id="cb417-8"><a href="금융-데이터-수집하기-기본.html#cb417-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb417-9"><a href="금융-데이터-수집하기-기본.html#cb417-9" aria-hidden="true" tabindex="-1"></a>otp <span class="ot">=</span> <span class="fu">POST</span>(gen_otp_url, <span class="at">query =</span> gen_otp_data) <span class="sc">%&gt;%</span></span>
<span id="cb417-10"><a href="금융-데이터-수집하기-기본.html#cb417-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>() <span class="sc">%&gt;%</span></span>
<span id="cb417-11"><a href="금융-데이터-수집하기-기본.html#cb417-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb417-12"><a href="금융-데이터-수집하기-기본.html#cb417-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-13"><a href="금융-데이터-수집하기-기본.html#cb417-13" aria-hidden="true" tabindex="-1"></a>down_sector_KQ <span class="ot">=</span> <span class="fu">POST</span>(down_url, <span class="at">query =</span> <span class="fu">list</span>(<span class="at">code =</span> otp),</span>
<span id="cb417-14"><a href="금융-데이터-수집하기-기본.html#cb417-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">add_headers</span>(<span class="at">referer =</span> gen_otp_url)) <span class="sc">%&gt;%</span></span>
<span id="cb417-15"><a href="금융-데이터-수집하기-기본.html#cb417-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb417-16"><a href="금융-데이터-수집하기-기본.html#cb417-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb417-17"><a href="금융-데이터-수집하기-기본.html#cb417-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>()</span></code></pre></div>
<p>코스피 데이터와 코스닥 데이터를 하나로 합치도록 합니다.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="금융-데이터-수집하기-기본.html#cb418-1" aria-hidden="true" tabindex="-1"></a>down_sector <span class="ot">=</span> <span class="fu">rbind</span>(down_sector_KS, down_sector_KQ)</span></code></pre></div>
<p>이를 csv 파일로 저장하겠습니다.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="금융-데이터-수집하기-기본.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">&#39;data&#39;</span>), <span class="cn">FALSE</span>, <span class="fu">dir.create</span>(<span class="st">&#39;data&#39;</span>))</span>
<span id="cb419-2"><a href="금융-데이터-수집하기-기본.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(down_sector, <span class="st">&#39;data/krx_sector.csv&#39;</span>)</span></code></pre></div>
<p>먼저 <code>ifelse()</code> 함수를 통해 data라는 이름의 폴더가 있으면 FALSE를 반환하고, 없으면 해당 이름으로 폴더를 생성해줍니다. 그 후 앞서 다운로드한 데이터를 data 폴더 안에 krx_sector.csv 이름으로 저장합니다. 해당 폴더를 확인해보면 데이터가 csv 형태로 저장되어 있습니다.</p>
</div>
<div id="개별종목-지표-크롤링" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> 개별종목 지표 크롤링</h3>
<p>개별종목 데이터를 크롤링하는 방법은 위와 매우 유사하며, 요청하는 쿼리 값에만 차이가 있습니다. 개발자 도구 화면을 열고 [CSV] 버튼을 클릭해 어떠한 쿼리를 요청하는지 확인합니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-262"></span>
<img src="images/crawl_practice_krx_ind.png" alt="개별지표 OTP 생성 부분" width="100%" />
<p class="caption">
그림 5.3: 개별지표 OTP 생성 부분
</p>
</div>
<p>이 중 tboxisuCd_finder_stkisu0_6, isu_Cd, isu_Cd2 등의 항목은 조회 구분의 개별추이 탭에 해당하는 부분이므로 우리가 원하는 전체 데이터를 받을 때는 필요하지 않은 요청값입니다. 이를 제외한 요청값을 산업별 현황 예제에 적용하면 해당 데이터 역시 손쉽게 다운로드할 수 있습니다.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="금융-데이터-수집하기-기본.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb420-2"><a href="금융-데이터-수집하기-기본.html#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb420-3"><a href="금융-데이터-수집하기-기본.html#cb420-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb420-4"><a href="금융-데이터-수집하기-기본.html#cb420-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-5"><a href="금융-데이터-수집하기-기본.html#cb420-5" aria-hidden="true" tabindex="-1"></a>gen_otp_url <span class="ot">=</span></span>
<span id="cb420-6"><a href="금융-데이터-수집하기-기본.html#cb420-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/GenerateOTP/generate.cmd&#39;</span></span>
<span id="cb420-7"><a href="금융-데이터-수집하기-기본.html#cb420-7" aria-hidden="true" tabindex="-1"></a>gen_otp_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb420-8"><a href="금융-데이터-수집하기-기본.html#cb420-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchType =</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb420-9"><a href="금융-데이터-수집하기-기본.html#cb420-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mktId =</span> <span class="st">&#39;ALL&#39;</span>,</span>
<span id="cb420-10"><a href="금융-데이터-수집하기-기본.html#cb420-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">trdDd =</span> <span class="st">&#39;20210108&#39;</span>,</span>
<span id="cb420-11"><a href="금융-데이터-수집하기-기본.html#cb420-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">csvxls_isNo =</span> <span class="st">&#39;false&#39;</span>,</span>
<span id="cb420-12"><a href="금융-데이터-수집하기-기본.html#cb420-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;fileDown&#39;</span>,</span>
<span id="cb420-13"><a href="금융-데이터-수집하기-기본.html#cb420-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&#39;dbms/MDC/STAT/standard/MDCSTAT03501&#39;</span></span>
<span id="cb420-14"><a href="금융-데이터-수집하기-기본.html#cb420-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb420-15"><a href="금융-데이터-수집하기-기본.html#cb420-15" aria-hidden="true" tabindex="-1"></a>otp <span class="ot">=</span> <span class="fu">POST</span>(gen_otp_url, <span class="at">query =</span> gen_otp_data) <span class="sc">%&gt;%</span></span>
<span id="cb420-16"><a href="금융-데이터-수집하기-기본.html#cb420-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>() <span class="sc">%&gt;%</span></span>
<span id="cb420-17"><a href="금융-데이터-수집하기-기본.html#cb420-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb420-18"><a href="금융-데이터-수집하기-기본.html#cb420-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-19"><a href="금융-데이터-수집하기-기본.html#cb420-19" aria-hidden="true" tabindex="-1"></a>down_url <span class="ot">=</span> <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/download_csv/download.cmd&#39;</span></span>
<span id="cb420-20"><a href="금융-데이터-수집하기-기본.html#cb420-20" aria-hidden="true" tabindex="-1"></a>down_ind <span class="ot">=</span> <span class="fu">POST</span>(down_url, <span class="at">query =</span> <span class="fu">list</span>(<span class="at">code =</span> otp),</span>
<span id="cb420-21"><a href="금융-데이터-수집하기-기본.html#cb420-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">add_headers</span>(<span class="at">referer =</span> gen_otp_url)) <span class="sc">%&gt;%</span></span>
<span id="cb420-22"><a href="금융-데이터-수집하기-기본.html#cb420-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb420-23"><a href="금융-데이터-수집하기-기본.html#cb420-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb420-24"><a href="금융-데이터-수집하기-기본.html#cb420-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>()</span></code></pre></div>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="금융-데이터-수집하기-기본.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(down_ind)</span></code></pre></div>
<pre><code>## # A tibble: 2,345 x 11
##    종목코드 종목명        종가  대비 등락률   EPS    PER    BPS   PBR 주당배당금
##    &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
##  1 060310   3S            2245   -45  -1.97    NA  NA       745  3.01          0
##  2 095570   AJ네트웍스    4540  -155  -3.3    982   4.62   6802  0.67        300
##  3 006840   AK홀딩스     25350   150   0.6   2168  11.7   62448  0.41        750
##  4 054620   APS홀딩스     7500  -150  -1.96    NA  NA     10530  0.71          0
##  5 265520   AP시스템     26000  -100  -0.38   671  38.8    7468  3.48         50
##  6 211270   AP위성        8100  -250  -2.99    51 159.     5479  1.48         70
##  7 027410   BGF           4905   -25  -0.51   281  17.5   15699  0.31        110
##  8 282330   BGF리테일   141000  4500   3.3   8763  16.1   36022  3.91       2700
##  9 138930   BNK금융지주   5780     0   0     1647   3.51  25415  0.23        360
## 10 001460   BYC         324500 10500   3.34 33265   9.75 517079  0.63       1100
## # ... with 2,335 more rows, and 1 more variable: 배당수익률 &lt;dbl&gt;</code></pre>
<p>위 과정을 통해 down_ind 변수에는 개별종목 지표 데이터가 저장되었습니다. 해당 데이터 역시 csv 파일로 저장하겠습니다.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="금융-데이터-수집하기-기본.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(down_ind, <span class="st">&#39;data/krx_ind.csv&#39;</span>)</span></code></pre></div>
</div>
<div id="최근-영업일-기준-데이터-받기" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> 최근 영업일 기준 데이터 받기</h3>
<p>위 예제의 쿼리 항목 중 date와 schdate 부분을 원하는 일자로 입력하면(예: 20190104) 해당일의 데이터를 다운로드할 수 있으며, 전 영업일 날짜를 입력하면 가장 최근의 데이터를 받을 수 있습니다. 그러나 매번 해당 항목을 입력하기는 번거로우므로 자동으로 반영되게 할 필요가 있습니다.</p>
<p>네이버 금융의 [국내증시 → 증시자금동향]에는 이전 2영업일에 해당하는 날짜가 있으며, 자동으로 날짜가 업데이트되어 편리합니다. 따라서 해당 부분을 크롤링해 쿼리 항목에 사용할 수 있습니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-266"></span>
<img src="images/crawl_practice_recentdate.png" alt="최근 영업일 부분" width="100%" />
<p class="caption">
그림 5.4: 최근 영업일 부분
</p>
</div>
<p>크롤링하고자 하는 데이터가 하나거나 소수일때는 HTML 구조를 모두 분해한 후 데이터를 추출하는 것보다 Xpath를 이용하는 것이 훨씬 효율적입니다. Xpath란 XML 중 특정 값의 태그나 속성을 찾기 쉽게 만든 주소라 생각하면 됩니다. 예를 들어 R 프로그램이 저장된 곳을 윈도우 탐색기를 이용해 이용하면 C:\Program Files\R\R-3.4.2 형태의 주소를 보이는데 이것은 윈도우의 path 문법입니다. XML 역시 이와 동일한 개념의 Xpath가 있습니다. 웹페이지에서 Xpath를 찾는 법은 다음과 같습니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-267"></span>
<img src="images/crawl_practice_xpath.png" alt="Xpath 복사하기" width="100%" />
<p class="caption">
그림 5.5: Xpath 복사하기
</p>
</div>
<p>먼저 크롤링하고자 하는 내용에 마우스 커서를 올린 채 마우스 오른쪽 버튼을 클릭한 후 [검사]를 선택합니다. 그러면 개발자 도구 화면이 열리며 해당 지점의 HTML 부분이 선택됩니다. 그 후 HTML 화면에서 마우스 오른쪽 버튼을 클릭하고 [Copy → Copy Xpath]를 선택하면 해당 지점의 Xpath가 복사됩니다.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb424-1"><a href="금융-데이터-수집하기-기본.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="er">//*[@id=&quot;type_0&quot;]/div/ul[2]/li/span</span></span></code></pre></div>
<style type="text/css">
//*[@id="type_0"]/div/ul[2]/li/span
</style>
<p>위에서 구한 날짜의 Xpath를 이용해 해당 데이터를 크롤링하겠습니다.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="금융-데이터-수집하기-기본.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb425-2"><a href="금융-데이터-수집하기-기본.html#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb425-3"><a href="금융-데이터-수집하기-기본.html#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb425-4"><a href="금융-데이터-수집하기-기본.html#cb425-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-5"><a href="금융-데이터-수집하기-기본.html#cb425-5" aria-hidden="true" tabindex="-1"></a>url <span class="ot">=</span> <span class="st">&#39;https://finance.naver.com/sise/sise_deposit.nhn&#39;</span></span>
<span id="cb425-6"><a href="금융-데이터-수집하기-기본.html#cb425-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-7"><a href="금융-데이터-수집하기-기본.html#cb425-7" aria-hidden="true" tabindex="-1"></a>biz_day <span class="ot">=</span> <span class="fu">GET</span>(url) <span class="sc">%&gt;%</span></span>
<span id="cb425-8"><a href="금융-데이터-수집하기-기본.html#cb425-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb425-9"><a href="금융-데이터-수집하기-기본.html#cb425-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="at">xpath =</span></span>
<span id="cb425-10"><a href="금융-데이터-수집하기-기본.html#cb425-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;//*[@id=&quot;type_1&quot;]/div/ul[2]/li/span&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb425-11"><a href="금융-데이터-수집하기-기본.html#cb425-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb425-12"><a href="금융-데이터-수집하기-기본.html#cb425-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_match</span>((<span class="st">&#39;[0-9]+.[0-9]+.[0-9]+&#39;</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb425-13"><a href="금융-데이터-수집하기-기본.html#cb425-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb425-14"><a href="금융-데이터-수집하기-기본.html#cb425-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-15"><a href="금융-데이터-수집하기-기본.html#cb425-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(biz_day)</span></code></pre></div>
<pre><code>## [1] &quot;20211103&quot;</code></pre>
<ol style="list-style-type: decimal">
<li>페이지의 url을 저장합니다.</li>
<li><code>GET()</code> 함수를 통해 해당 페이지 내용을 받습니다.</li>
<li><code>read_html()</code> 함수를 이용해 해당 페이지의 HTML 내용을 읽어오며, 인코딩은 EUC-KR로 설정합니다.</li>
<li><code>html_node()</code> 함수 내에 위에서 구한 Xpath를 입력해서 해당 지점의 데이터를 추출합니다.</li>
<li><code>html_text()</code> 함수를 통해 텍스트 데이터만을 추출합니다.</li>
<li><code>str_match()</code> 함수 내에서 정규표현식<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>을 이용해 숫자.숫자.숫자 형식의 데이터를 추출합니다.</li>
<li><code>str_replace_all()</code> 함수를 이용해 마침표(.)를 모두 없애줍니다.</li>
</ol>
<p>이처럼 Xpath를 이용하면 태그나 속성을 분해하지 않고도 원하는 지점의 데이터를 크롤링할 수 있습니다. 위 과정을 통해 yyyymmdd 형태의 날짜만 남게 되었습니다. 이를 위의 date와 schdate에 입력하면 산업별 현황과 개별종목 지표를 최근일자 기준으로 다운로드하게 됩니다. 전체 코드는 다음과 같습니다.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="금융-데이터-수집하기-기본.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb427-2"><a href="금융-데이터-수집하기-기본.html#cb427-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb427-3"><a href="금융-데이터-수집하기-기본.html#cb427-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb427-4"><a href="금융-데이터-수집하기-기본.html#cb427-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb427-5"><a href="금융-데이터-수집하기-기본.html#cb427-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-6"><a href="금융-데이터-수집하기-기본.html#cb427-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 최근 영업일 구하기</span></span>
<span id="cb427-7"><a href="금융-데이터-수집하기-기본.html#cb427-7" aria-hidden="true" tabindex="-1"></a>url <span class="ot">=</span> <span class="st">&#39;https://finance.naver.com/sise/sise_deposit.nhn&#39;</span></span>
<span id="cb427-8"><a href="금융-데이터-수집하기-기본.html#cb427-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-9"><a href="금융-데이터-수집하기-기본.html#cb427-9" aria-hidden="true" tabindex="-1"></a>biz_day <span class="ot">=</span> <span class="fu">GET</span>(url) <span class="sc">%&gt;%</span></span>
<span id="cb427-10"><a href="금융-데이터-수집하기-기본.html#cb427-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb427-11"><a href="금융-데이터-수집하기-기본.html#cb427-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="at">xpath =</span></span>
<span id="cb427-12"><a href="금융-데이터-수집하기-기본.html#cb427-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;//*[@id=&quot;type_1&quot;]/div/ul[2]/li/span&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb427-13"><a href="금융-데이터-수집하기-기본.html#cb427-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-14"><a href="금융-데이터-수집하기-기본.html#cb427-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_match</span>((<span class="st">&#39;[0-9]+.[0-9]+.[0-9]+&#39;</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb427-15"><a href="금융-데이터-수집하기-기본.html#cb427-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb427-16"><a href="금융-데이터-수집하기-기본.html#cb427-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-17"><a href="금융-데이터-수집하기-기본.html#cb427-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 코스피 업종분류 OTP 발급</span></span>
<span id="cb427-18"><a href="금융-데이터-수집하기-기본.html#cb427-18" aria-hidden="true" tabindex="-1"></a>gen_otp_url <span class="ot">=</span></span>
<span id="cb427-19"><a href="금융-데이터-수집하기-기본.html#cb427-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/GenerateOTP/generate.cmd&#39;</span></span>
<span id="cb427-20"><a href="금융-데이터-수집하기-기본.html#cb427-20" aria-hidden="true" tabindex="-1"></a>gen_otp_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb427-21"><a href="금융-데이터-수집하기-기본.html#cb427-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">mktId =</span> <span class="st">&#39;STK&#39;</span>,</span>
<span id="cb427-22"><a href="금융-데이터-수집하기-기본.html#cb427-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">trdDd =</span> biz_day, <span class="co"># 최근영업일로 변경</span></span>
<span id="cb427-23"><a href="금융-데이터-수집하기-기본.html#cb427-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">money =</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb427-24"><a href="금융-데이터-수집하기-기본.html#cb427-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">csvxls_isNo =</span> <span class="st">&#39;false&#39;</span>,</span>
<span id="cb427-25"><a href="금융-데이터-수집하기-기본.html#cb427-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;fileDown&#39;</span>,</span>
<span id="cb427-26"><a href="금융-데이터-수집하기-기본.html#cb427-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&#39;dbms/MDC/STAT/standard/MDCSTAT03901&#39;</span></span>
<span id="cb427-27"><a href="금융-데이터-수집하기-기본.html#cb427-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb427-28"><a href="금융-데이터-수집하기-기본.html#cb427-28" aria-hidden="true" tabindex="-1"></a>otp <span class="ot">=</span> <span class="fu">POST</span>(gen_otp_url, <span class="at">query =</span> gen_otp_data) <span class="sc">%&gt;%</span></span>
<span id="cb427-29"><a href="금융-데이터-수집하기-기본.html#cb427-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-30"><a href="금융-데이터-수집하기-기본.html#cb427-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb427-31"><a href="금융-데이터-수집하기-기본.html#cb427-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-32"><a href="금융-데이터-수집하기-기본.html#cb427-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 코스피 업종분류 데이터 다운로드</span></span>
<span id="cb427-33"><a href="금융-데이터-수집하기-기본.html#cb427-33" aria-hidden="true" tabindex="-1"></a>down_url <span class="ot">=</span> <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/download_csv/download.cmd&#39;</span></span>
<span id="cb427-34"><a href="금융-데이터-수집하기-기본.html#cb427-34" aria-hidden="true" tabindex="-1"></a>down_sector_KS <span class="ot">=</span> <span class="fu">POST</span>(down_url, <span class="at">query =</span> <span class="fu">list</span>(<span class="at">code =</span> otp),</span>
<span id="cb427-35"><a href="금융-데이터-수집하기-기본.html#cb427-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">add_headers</span>(<span class="at">referer =</span> gen_otp_url)) <span class="sc">%&gt;%</span></span>
<span id="cb427-36"><a href="금융-데이터-수집하기-기본.html#cb427-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb427-37"><a href="금융-데이터-수집하기-기본.html#cb427-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-38"><a href="금융-데이터-수집하기-기본.html#cb427-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>()</span>
<span id="cb427-39"><a href="금융-데이터-수집하기-기본.html#cb427-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-40"><a href="금융-데이터-수집하기-기본.html#cb427-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 코스닥 업종분류 OTP 발급</span></span>
<span id="cb427-41"><a href="금융-데이터-수집하기-기본.html#cb427-41" aria-hidden="true" tabindex="-1"></a>gen_otp_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb427-42"><a href="금융-데이터-수집하기-기본.html#cb427-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">mktId =</span> <span class="st">&#39;KSQ&#39;</span>,</span>
<span id="cb427-43"><a href="금융-데이터-수집하기-기본.html#cb427-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">trdDd =</span> biz_day, <span class="co"># 최근영업일로 변경</span></span>
<span id="cb427-44"><a href="금융-데이터-수집하기-기본.html#cb427-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">money =</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb427-45"><a href="금융-데이터-수집하기-기본.html#cb427-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">csvxls_isNo =</span> <span class="st">&#39;false&#39;</span>,</span>
<span id="cb427-46"><a href="금융-데이터-수집하기-기본.html#cb427-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;fileDown&#39;</span>,</span>
<span id="cb427-47"><a href="금융-데이터-수집하기-기본.html#cb427-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&#39;dbms/MDC/STAT/standard/MDCSTAT03901&#39;</span></span>
<span id="cb427-48"><a href="금융-데이터-수집하기-기본.html#cb427-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb427-49"><a href="금융-데이터-수집하기-기본.html#cb427-49" aria-hidden="true" tabindex="-1"></a>otp <span class="ot">=</span> <span class="fu">POST</span>(gen_otp_url, <span class="at">query =</span> gen_otp_data) <span class="sc">%&gt;%</span></span>
<span id="cb427-50"><a href="금융-데이터-수집하기-기본.html#cb427-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-51"><a href="금융-데이터-수집하기-기본.html#cb427-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb427-52"><a href="금융-데이터-수집하기-기본.html#cb427-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-53"><a href="금융-데이터-수집하기-기본.html#cb427-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 코스닥 업종분류 데이터 다운로드</span></span>
<span id="cb427-54"><a href="금융-데이터-수집하기-기본.html#cb427-54" aria-hidden="true" tabindex="-1"></a>down_sector_KQ <span class="ot">=</span> <span class="fu">POST</span>(down_url, <span class="at">query =</span> <span class="fu">list</span>(<span class="at">code =</span> otp),</span>
<span id="cb427-55"><a href="금융-데이터-수집하기-기본.html#cb427-55" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">add_headers</span>(<span class="at">referer =</span> gen_otp_url)) <span class="sc">%&gt;%</span></span>
<span id="cb427-56"><a href="금융-데이터-수집하기-기본.html#cb427-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb427-57"><a href="금융-데이터-수집하기-기본.html#cb427-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-58"><a href="금융-데이터-수집하기-기본.html#cb427-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>()</span>
<span id="cb427-59"><a href="금융-데이터-수집하기-기본.html#cb427-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-60"><a href="금융-데이터-수집하기-기본.html#cb427-60" aria-hidden="true" tabindex="-1"></a>down_sector <span class="ot">=</span> <span class="fu">rbind</span>(down_sector_KS, down_sector_KQ)</span>
<span id="cb427-61"><a href="금융-데이터-수집하기-기본.html#cb427-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-62"><a href="금융-데이터-수집하기-기본.html#cb427-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">&#39;data&#39;</span>), <span class="cn">FALSE</span>, <span class="fu">dir.create</span>(<span class="st">&#39;data&#39;</span>))</span>
<span id="cb427-63"><a href="금융-데이터-수집하기-기본.html#cb427-63" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(down_sector, <span class="st">&#39;data/krx_sector.csv&#39;</span>)</span>
<span id="cb427-64"><a href="금융-데이터-수집하기-기본.html#cb427-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-65"><a href="금융-데이터-수집하기-기본.html#cb427-65" aria-hidden="true" tabindex="-1"></a><span class="co"># 개별종목 지표 OTP 발급</span></span>
<span id="cb427-66"><a href="금융-데이터-수집하기-기본.html#cb427-66" aria-hidden="true" tabindex="-1"></a>gen_otp_url <span class="ot">=</span></span>
<span id="cb427-67"><a href="금융-데이터-수집하기-기본.html#cb427-67" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/GenerateOTP/generate.cmd&#39;</span></span>
<span id="cb427-68"><a href="금융-데이터-수집하기-기본.html#cb427-68" aria-hidden="true" tabindex="-1"></a>gen_otp_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb427-69"><a href="금융-데이터-수집하기-기본.html#cb427-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchType =</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb427-70"><a href="금융-데이터-수집하기-기본.html#cb427-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">mktId =</span> <span class="st">&#39;ALL&#39;</span>,</span>
<span id="cb427-71"><a href="금융-데이터-수집하기-기본.html#cb427-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">trdDd =</span> biz_day, <span class="co"># 최근영업일로 변경</span></span>
<span id="cb427-72"><a href="금융-데이터-수집하기-기본.html#cb427-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">csvxls_isNo =</span> <span class="st">&#39;false&#39;</span>,</span>
<span id="cb427-73"><a href="금융-데이터-수집하기-기본.html#cb427-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;fileDown&#39;</span>,</span>
<span id="cb427-74"><a href="금융-데이터-수집하기-기본.html#cb427-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&#39;dbms/MDC/STAT/standard/MDCSTAT03501&#39;</span></span>
<span id="cb427-75"><a href="금융-데이터-수집하기-기본.html#cb427-75" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb427-76"><a href="금융-데이터-수집하기-기본.html#cb427-76" aria-hidden="true" tabindex="-1"></a>otp <span class="ot">=</span> <span class="fu">POST</span>(gen_otp_url, <span class="at">query =</span> gen_otp_data) <span class="sc">%&gt;%</span></span>
<span id="cb427-77"><a href="금융-데이터-수집하기-기본.html#cb427-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-78"><a href="금융-데이터-수집하기-기본.html#cb427-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb427-79"><a href="금융-데이터-수집하기-기본.html#cb427-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-80"><a href="금융-데이터-수집하기-기본.html#cb427-80" aria-hidden="true" tabindex="-1"></a><span class="co"># 개별종목 지표 데이터 다운로드</span></span>
<span id="cb427-81"><a href="금융-데이터-수집하기-기본.html#cb427-81" aria-hidden="true" tabindex="-1"></a>down_url <span class="ot">=</span> <span class="st">&#39;http://data.krx.co.kr/comm/fileDn/download_csv/download.cmd&#39;</span></span>
<span id="cb427-82"><a href="금융-데이터-수집하기-기본.html#cb427-82" aria-hidden="true" tabindex="-1"></a>down_ind <span class="ot">=</span> <span class="fu">POST</span>(down_url, <span class="at">query =</span> <span class="fu">list</span>(<span class="at">code =</span> otp),</span>
<span id="cb427-83"><a href="금융-데이터-수집하기-기본.html#cb427-83" aria-hidden="true" tabindex="-1"></a>                <span class="fu">add_headers</span>(<span class="at">referer =</span> gen_otp_url)) <span class="sc">%&gt;%</span></span>
<span id="cb427-84"><a href="금융-데이터-수집하기-기본.html#cb427-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(<span class="at">encoding =</span> <span class="st">&#39;EUC-KR&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb427-85"><a href="금융-데이터-수집하기-기본.html#cb427-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-86"><a href="금융-데이터-수집하기-기본.html#cb427-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>()</span>
<span id="cb427-87"><a href="금융-데이터-수집하기-기본.html#cb427-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-88"><a href="금융-데이터-수집하기-기본.html#cb427-88" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(down_ind, <span class="st">&#39;data/krx_ind.csv&#39;</span>)</span></code></pre></div>
</div>
<div id="거래소-데이터-정리하기" class="section level3" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> 거래소 데이터 정리하기</h3>
<p>위에서 다운로드한 데이터는 중복된 열이 있으며, 불필요한 데이터 역시 있습니다. 따라서 하나의 테이블로 합친 후 정리할 필요가 있습니다. 먼저 다운로드한 csv 파일을 읽어옵니다.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="금융-데이터-수집하기-기본.html#cb428-1" aria-hidden="true" tabindex="-1"></a>down_sector <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/krx_sector.csv&#39;</span>, <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb428-2"><a href="금융-데이터-수집하기-기본.html#cb428-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb428-3"><a href="금융-데이터-수집하기-기본.html#cb428-3" aria-hidden="true" tabindex="-1"></a>down_ind <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/krx_ind.csv&#39;</span>,  <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb428-4"><a href="금융-데이터-수집하기-기본.html#cb428-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><code>read.csv()</code> 함수를 이용해 csv 파일을 불러옵니다. <code>row.names = 1</code>을 통해 첫 번째 열을 행 이름으로 지정하고, <code>stringsAsFactors = FALSE</code>를 통해 문자열 데이터가 팩터 형태로 변형되지 않게 합니다.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="금융-데이터-수집하기-기본.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(<span class="fu">names</span>(down_sector), <span class="fu">names</span>(down_ind))</span></code></pre></div>
<pre><code>## [1] &quot;종목코드&quot; &quot;종목명&quot;   &quot;종가&quot;     &quot;대비&quot;     &quot;등락률&quot;</code></pre>
<p>먼저 <code>intersect()</code> 함수를 통해 두 데이터 간 중복되는 열 이름을 살펴보면 종목코드와 종목명 등이 동일한 위치에 있습니다.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="금융-데이터-수집하기-기본.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(down_sector[, <span class="st">&#39;종목명&#39;</span>], down_ind[ ,<span class="st">&#39;종목명&#39;</span>])</span></code></pre></div>
<pre><code>##  [1] &quot;ESR켄달스퀘어리츠&quot;    &quot;NH프라임리츠&quot;         &quot;SK리츠&quot;              
##  [4] &quot;디앤디플랫폼리츠&quot;     &quot;롯데리츠&quot;             &quot;맥쿼리인프라&quot;        
##  [7] &quot;맵스리얼티1&quot;          &quot;모두투어리츠&quot;         &quot;미래에셋맵스리츠&quot;    
## [10] &quot;바다로19호&quot;           &quot;베트남개발1&quot;          &quot;신한알파리츠&quot;        
## [13] &quot;에이리츠&quot;             &quot;엘브이엠씨홀딩스&quot;     &quot;이리츠코크렙&quot;        
## [16] &quot;이지스레지던스리츠&quot;   &quot;이지스밸류리츠&quot;       &quot;제이알글로벌리츠&quot;    
## [19] &quot;케이탑리츠&quot;           &quot;코람코에너지리츠&quot;     &quot;프레스티지바이오파마&quot;
## [22] &quot;하이골드12호&quot;         &quot;하이골드3호&quot;          &quot;한국ANKOR유전&quot;       
## [25] &quot;한국패러랠&quot;           &quot;현대두산인프라코어&quot;   &quot;GRT&quot;                 
## [28] &quot;JTC&quot;                  &quot;SBI핀테크솔루션즈&quot;    &quot;SNK&quot;                 
## [31] &quot;골든센츄리&quot;           &quot;글로벌에스엠&quot;         &quot;네오이뮨텍(Reg.S)&quot;   
## [34] &quot;로스웰&quot;               &quot;미투젠&quot;               &quot;소마젠&quot;              
## [37] &quot;씨케이에이치&quot;         &quot;애머릿지&quot;             &quot;엑세스바이오&quot;        
## [40] &quot;오가닉티코스메틱&quot;     &quot;윙입푸드&quot;             &quot;이스트아시아홀딩스&quot;  
## [43] &quot;잉글우드랩&quot;           &quot;컬러레이&quot;             &quot;코오롱티슈진&quot;        
## [46] &quot;크리스탈신소재&quot;       &quot;헝셩그룹&quot;</code></pre>
<p><code>setdiff()</code> 함수를 통해 두 데이터에 공통적으로 없는 종목명, 즉 하나의 데이터에만 있는 종목을 살펴보면 위와 같습니다. 해당 종목들은 선박펀드, 광물펀드, 해외종목 등 일반적이지 않은 종목들이므로 제외하는 것이 좋습니다. 따라서 둘 사이에 공통적으로 존재하는 종목을 기준으로 데이터를 합쳐주겠습니다.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="금융-데이터-수집하기-기본.html#cb433-1" aria-hidden="true" tabindex="-1"></a>KOR_ticker <span class="ot">=</span> <span class="fu">merge</span>(down_sector, down_ind,</span>
<span id="cb433-2"><a href="금융-데이터-수집하기-기본.html#cb433-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">intersect</span>(<span class="fu">names</span>(down_sector),</span>
<span id="cb433-3"><a href="금융-데이터-수집하기-기본.html#cb433-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">names</span>(down_ind)),</span>
<span id="cb433-4"><a href="금융-데이터-수집하기-기본.html#cb433-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all =</span> <span class="cn">FALSE</span></span>
<span id="cb433-5"><a href="금융-데이터-수집하기-기본.html#cb433-5" aria-hidden="true" tabindex="-1"></a>                   )</span></code></pre></div>
<p><code>merge()</code> 함수는 by를 기준으로 두 데이터를 하나로 합치며, 공통으로 존재하는 종목코드, 종목명, 종가, 대비, 등락률을 기준으로 입력해줍니다. 또한 all 값을 TRUE로 설정하면 합집합을 반환하고, FALSE로 설정하면 교집합을 반환합니다. 공통으로 존재하는 항목을 원하므로 여기서는 FALSE를 입력합니다.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="금융-데이터-수집하기-기본.html#cb434-1" aria-hidden="true" tabindex="-1"></a>KOR_ticker <span class="ot">=</span> KOR_ticker[<span class="fu">order</span>(<span class="sc">-</span>KOR_ticker[<span class="st">&#39;시가총액&#39;</span>]), ]</span>
<span id="cb434-2"><a href="금융-데이터-수집하기-기본.html#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(KOR_ticker))</span></code></pre></div>
<pre><code>##      종목코드           종목명   종가   대비 등락률 시장구분   업종명  시가총액
## 326    005930         삼성전자  70400  -1100  -1.54    KOSPI 전기전자 4.203e+14
## 45     000660       SK하이닉스 105500  -2000  -1.86    KOSPI 전기전자 7.680e+13
## 837    035420            NAVER 402500  -7500  -1.83    KOSPI 서비스업 6.612e+13
## 1920   207940 삼성바이오로직스 874000      0   0.00    KOSPI   의약품 5.783e+13
## 843    035720           카카오 124500  -3500  -2.73    KOSPI 서비스업 5.545e+13
## 1062   051910           LG화학 784000 -47000  -5.66    KOSPI     화학 5.534e+13
##       EPS    PER    BPS   PBR 주당배당금 배당수익률
## 326  3841  18.33  39406  1.79       2994       4.25
## 45   6952  15.18  71275  1.48       1170       1.11
## 837  6877  58.53  44850  8.97        402       0.10
## 1920 3642 239.98  69505 12.57          0       0.00
## 843   369 337.40  14286  8.71         30       0.02
## 1062 6666 117.61 230440  3.40      10000       1.28</code></pre>
<p>데이터를 시가총액 기준으로 내림차순 정렬할 필요도 있습니다. <code>order()</code> 함수를 통해 상대적인 순서를 구할 수 있습니다. R은 기본적으로 오름차순으로 순서를 구하므로 앞에 마이너스(-)를 붙여 내림차순 형태로 바꿉니다. 결과적으로 시가총액 기준 내림차
순으로 해당 데이터가 정렬됩니다.</p>
<p>마지막으로 스팩, 우선주 종목 역시 제외해야 합니다.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="금융-데이터-수집하기-기본.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb436-2"><a href="금융-데이터-수집하기-기본.html#cb436-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-3"><a href="금융-데이터-수집하기-기본.html#cb436-3" aria-hidden="true" tabindex="-1"></a>KOR_ticker[<span class="fu">grepl</span>(<span class="st">&#39;스팩&#39;</span>, KOR_ticker[, <span class="st">&#39;종목명&#39;</span>]), <span class="st">&#39;종목명&#39;</span>]  </span></code></pre></div>
<pre><code>##  [1] &quot;엔에이치스팩19호&quot;     &quot;엔에이치스팩20호&quot;     &quot;삼성스팩4호&quot;         
##  [4] &quot;IBKS제14호스팩&quot;       &quot;삼성머스트스팩5호&quot;    &quot;하나금융17호스팩&quot;    
##  [7] &quot;엔에이치스팩17호&quot;     &quot;대신밸런스제9호스팩&quot;  &quot;케이비제18호스팩&quot;    
## [10] &quot;엔에이치스팩21호&quot;     &quot;신한제8호스팩&quot;        &quot;상상인이안1호스팩&quot;   
## [13] &quot;유안타제5호스팩&quot;      &quot;대신밸런스제8호스팩&quot;  &quot;케이비제20호스팩&quot;    
## [16] &quot;유안타제8호스팩&quot;      &quot;미래에셋대우스팩3호&quot;  &quot;하나금융19호스팩&quot;    
## [19] &quot;DB금융스팩8호&quot;        &quot;한화플러스제1호스팩&quot;  &quot;대신밸런스제7호스팩&quot; 
## [22] &quot;한화플러스제2호스팩&quot;  &quot;SK6호스팩&quot;            &quot;유안타제7호스팩&quot;     
## [25] &quot;한국9호스팩&quot;          &quot;대신밸런스제10호스팩&quot; &quot;엔에이치스팩18호&quot;    
## [28] &quot;하이제6호스팩&quot;        &quot;교보10호스팩&quot;         &quot;케이비17호스팩&quot;      
## [31] &quot;한국제8호스팩&quot;        &quot;IBKS제13호스팩&quot;       &quot;유진스팩7호&quot;         
## [34] &quot;에이치엠씨제5호스팩&quot;  &quot;하이제5호스팩&quot;        &quot;신한제6호스팩&quot;       
## [37] &quot;미래에셋대우스팩 5호&quot; &quot;DB금융스팩9호&quot;        &quot;하나금융15호스팩&quot;    
## [40] &quot;신한제7호스팩&quot;        &quot;한화에스비아이스팩&quot;   &quot;하나머스트7호스팩&quot;   
## [43] &quot;하나금융14호스팩&quot;     &quot;유안타제4호스팩&quot;      &quot;SK5호스팩&quot;           
## [46] &quot;신영스팩6호&quot;          &quot;에이치엠씨제4호스팩&quot;  &quot;케이비제19호스팩&quot;    
## [49] &quot;하나금융16호스팩&quot;     &quot;IBKS제15호스팩&quot;       &quot;교보9호스팩&quot;         
## [52] &quot;상상인이안제2호스팩&quot;  &quot;이베스트스팩5호&quot;      &quot;IBKS제16호스팩&quot;      
## [55] &quot;신영스팩5호&quot;          &quot;IBKS제12호스팩&quot;       &quot;유진스팩6호&quot;         
## [58] &quot;이베스트이안스팩1호&quot;</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="금융-데이터-수집하기-기본.html#cb438-1" aria-hidden="true" tabindex="-1"></a>KOR_ticker[<span class="fu">str_sub</span>(KOR_ticker[, <span class="st">&#39;종목코드&#39;</span>], <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">!=</span> <span class="dv">0</span>, <span class="st">&#39;종목명&#39;</span>]</span></code></pre></div>
<pre><code>##   [1] &quot;삼성전자우&quot;         &quot;현대차2우B&quot;         &quot;LG화학우&quot;          
##   [4] &quot;현대차우&quot;           &quot;LG생활건강우&quot;       &quot;LG전자우&quot;          
##   [7] &quot;아모레퍼시픽우&quot;     &quot;미래에셋증권2우B&quot;   &quot;삼성SDI우&quot;         
##  [10] &quot;삼성화재우&quot;         &quot;대신증권우&quot;         &quot;신영증권우&quot;        
##  [13] &quot;한국금융지주우&quot;     &quot;한화3우B&quot;           &quot;CJ4우(전환)&quot;       
##  [16] &quot;금호석유우&quot;         &quot;두산우&quot;             &quot;삼성전기우&quot;        
##  [19] &quot;아모레G3우(전환)&quot;   &quot;CJ제일제당 우&quot;      &quot;S-Oil우&quot;           
##  [22] &quot;NH투자증권우&quot;       &quot;현대차3우B&quot;         &quot;두산퓨얼셀1우&quot;     
##  [25] &quot;LG우&quot;               &quot;SK이노베이션우&quot;     &quot;대신증권2우B&quot;      
##  [28] &quot;삼성물산우B&quot;        &quot;DL이앤씨우&quot;         &quot;SK케미칼우&quot;        
##  [31] &quot;솔루스첨단소재1우&quot;  &quot;신풍제약우&quot;         &quot;CJ우&quot;              
##  [34] &quot;SK우&quot;               &quot;아모레G우&quot;          &quot;두산2우B&quot;          
##  [37] &quot;코오롱인더우&quot;       &quot;미래에셋증권우&quot;     &quot;한화투자증권우&quot;    
##  [40] &quot;부국증권우&quot;         &quot;유한양행우&quot;         &quot;DL우&quot;              
##  [43] &quot;GS우&quot;               &quot;호텔신라우&quot;         &quot;대교우B&quot;           
##  [46] &quot;두산퓨얼셀2우B&quot;     &quot;유안타증권우&quot;       &quot;녹십자홀딩스2우&quot;   
##  [49] &quot;롯데칠성우&quot;         &quot;SK디스커버리우&quot;     &quot;롯데지주우&quot;        
##  [52] &quot;솔루스첨단소재2우B&quot; &quot;유화증권우&quot;         &quot;한화솔루션우&quot;      
##  [55] &quot;대한항공우&quot;         &quot;덕성우&quot;             &quot;BYC우&quot;             
##  [58] &quot;남양유업우&quot;         &quot;LX하우시스우&quot;       &quot;티와이홀딩스우&quot;    
##  [61] &quot;삼성중공우&quot;         &quot;대덕전자1우&quot;        &quot;세방우&quot;            
##  [64] &quot;대상우&quot;             &quot;하이트진로2우B&quot;     &quot;유유제약1우&quot;       
##  [67] &quot;대한제당우&quot;         &quot;코오롱우&quot;           &quot;넥센타이어1우B&quot;    
##  [70] &quot;삼양홀딩스우&quot;       &quot;코리아써우&quot;         &quot;LX홀딩스1우&quot;       
##  [73] &quot;한진칼우&quot;           &quot;한화우&quot;             &quot;태영건설우&quot;        
##  [76] &quot;NPC우&quot;              &quot;삼양사우&quot;           &quot;SK증권우&quot;          
##  [79] &quot;일양약품우&quot;         &quot;대덕1우&quot;            &quot;넥센우&quot;            
##  [82] &quot;크라운제과우&quot;       &quot;성신양회우&quot;         &quot;노루페인트우&quot;      
##  [85] &quot;DB하이텍1우&quot;        &quot;한양증권우&quot;         &quot;현대건설우&quot;        
##  [88] &quot;대상홀딩스우&quot;       &quot;코오롱글로벌우&quot;     &quot;계양전기우&quot;        
##  [91] &quot;태양금속우&quot;         &quot;SK네트웍스우&quot;       &quot;서울식품우&quot;        
##  [94] &quot;금호건설우&quot;         &quot;노루홀딩스우&quot;       &quot;동부건설우&quot;        
##  [97] &quot;대원전선우&quot;         &quot;동원시스템즈우&quot;     &quot;깨끗한나라우&quot;      
## [100] &quot;현대비앤지스틸우&quot;   &quot;루트로닉3우C&quot;       &quot;크라운해태홀딩스우&quot;
## [103] &quot;하이트진로홀딩스우&quot; &quot;CJ씨푸드1우&quot;        &quot;금강공업우&quot;        
## [106] &quot;남선알미우&quot;         &quot;유유제약2우B&quot;       &quot;코리아써키트2우B&quot;  
## [109] &quot;흥국화재우&quot;         &quot;대호특수강우&quot;       &quot;JW중외제약우&quot;      
## [112] &quot;성문전자우&quot;         &quot;JW중외제약2우B&quot;     &quot;KG동부제철우&quot;      
## [115] &quot;진흥기업우B&quot;        &quot;동양우&quot;             &quot;동양2우B&quot;          
## [118] &quot;소프트센우&quot;         &quot;신원우&quot;             &quot;흥국화재2우B&quot;      
## [121] &quot;진흥기업2우B&quot;       &quot;동양3우B&quot;</code></pre>
<p><code>grepl()</code> 함수를 통해 종목명에 ‘스팩’이 들어가는 종목을 찾고, <code>stringr</code> 패키지의 <code>str_sub()</code> 함수를 통해 종목코드 끝이 0이 아닌 우선주 종목을 찾을 수 있습니다.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="금융-데이터-수집하기-기본.html#cb440-1" aria-hidden="true" tabindex="-1"></a>KOR_ticker <span class="ot">=</span> KOR_ticker[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;스팩&#39;</span>, KOR_ticker[, <span class="st">&#39;종목명&#39;</span>]), ]  </span>
<span id="cb440-2"><a href="금융-데이터-수집하기-기본.html#cb440-2" aria-hidden="true" tabindex="-1"></a>KOR_ticker <span class="ot">=</span> KOR_ticker[<span class="fu">str_sub</span>(KOR_ticker[, <span class="st">&#39;종목코드&#39;</span>], <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">==</span> <span class="dv">0</span>, ]</span></code></pre></div>
<p>마지막으로 행 이름을 초기화한 후 정리된 데이터를 csv 파일로 저장합니다.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="금융-데이터-수집하기-기본.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(KOR_ticker) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb441-2"><a href="금융-데이터-수집하기-기본.html#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(KOR_ticker, <span class="st">&#39;data/KOR_ticker.csv&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="wics-기준-섹터정보-크롤링" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> WICS 기준 섹터정보 크롤링</h2>
<p>일반적으로 주식의 섹터를 나누는 기준은 MSCI와 S&amp;P가 개발한 GICS<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>를 가장 많이 사용합니다. 국내 종목의 GICS 기준 정보 역시 한국거래소에서 제공하고 있으나, 이는 독점적 지적재산으로 명시했기에 사용하는 데 무리가 있습니다. 그러나 지수제공업체인 와이즈인덱스<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>에서는 GICS와 비슷한 WICS 산업분류를 발표하고 있습니다. WICS를 크롤링해 필요한 정보를 수집해보겠습니다.</p>
<p>먼저 웹페이지에 접속해 [Index → WISE SECTOR INDEX → WICS → 에너지]를 클릭합니다. 그 후 [Components] 탭을 클릭하면 해당 섹터의 구성종목을 확인할 수 있습니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-279"></span>
<img src="images/crawl_practice_wics.png" alt="WICS 기준 구성종목" width="100%" />
<p class="caption">
그림 5.6: WICS 기준 구성종목
</p>
</div>
<p>개발자도구 화면(그림 <a href="금융-데이터-수집하기-기본.html#fig:wicurl">5.7</a>)을 통해 해당 페이지의 데이터전송 과정을 살펴보도록 하겠습니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:wicurl"></span>
<img src="images/crawl_practice_wics2.png" alt="WICS 페이지 개발자도구 화면" width="100%" />
<p class="caption">
그림 5.7: WICS 페이지 개발자도구 화면
</p>
</div>
<p>일자를 선택하면 [Network] 탭의 GetIndexComponets 항목을 통해 데이터 전송 과정이 나타납니다. Request URL의 주소를 살펴보면 다음과 같습니다.</p>
<ol style="list-style-type: decimal">
<li><a href="http://www.wiseindex.com/Index/GetIndexComponets" class="uri">http://www.wiseindex.com/Index/GetIndexComponets</a>: 데이터를 요청하는 url 입니다.</li>
<li>ceil_yn = 0: 실링 여부를 나타내며, 0은 비실링을 의미합니다.</li>
<li>dt=20190607: 조회일자를 나타냅니다.</li>
<li>sec_cd=G10: 섹터 코드를 나타냅니다.</li>
</ol>
<p>이번엔 위 주소의 페이지를 열어보겠습니다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-280"></span>
<img src="images/crawl_practice_wics3.png" alt="WICS 데이터 페이지" width="100%" />
<p class="caption">
그림 5.8: WICS 데이터 페이지
</p>
</div>
<p>글자들은 페이지에 출력된 내용이지만 매우 특이한 형태로 구성되어 있는데 이것은 JSON 형식의 데이터입니다. 기존에 우리가 살펴보았던 대부분의 웹페이지는 XML 형식으로 표현되어 있습니다. XML 형식은 문법이 복잡하고 표현 규칙이 엄격해 데이터의 용량이 커지는 단점이 있습니다. 반면 JSON 형식은 문법이 단순하고 데이터의 용량이 작아 빠른 속도로 데이터를 교환할 수 있습니다. R에서는 jsonlite 패키지의 <code>fromJSON()</code> 함수를 사용해 매우 손쉽게 JSON 형식의 데이터를 크롤링할 수 있습니다.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="금융-데이터-수집하기-기본.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb442-2"><a href="금융-데이터-수집하기-기본.html#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="금융-데이터-수집하기-기본.html#cb442-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">=</span> <span class="st">&#39;http://www.wiseindex.com/Index/GetIndexComponets?ceil_yn=0&amp;dt=20190607&amp;sec_cd=G10&#39;</span></span>
<span id="cb442-4"><a href="금융-데이터-수집하기-기본.html#cb442-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">fromJSON</span>(url)</span>
<span id="cb442-5"><a href="금융-데이터-수집하기-기본.html#cb442-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-6"><a href="금융-데이터-수집하기-기본.html#cb442-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(data, head)</span></code></pre></div>
<pre><code>## $info
## $info$TRD_DT
## [1] &quot;/Date(1559833200000)/&quot;
## 
## $info$MKT_VAL
## [1] 19850082
## 
## $info$TRD_AMT
## [1] 70030
## 
## $info$CNT
## [1] 23
## 
## 
## $list
##   IDX_CD  IDX_NM_KOR ALL_MKT_VAL CMP_CD            CMP_KOR MKT_VAL   WGT S_WGT
## 1    G10 WICS 에너지    19850082 096770       SK이노베이션 9052841 45.61 45.61
## 2    G10 WICS 에너지    19850082 010950              S-Oil 3403265 17.14 62.75
## 3    G10 WICS 에너지    19850082 267250     현대중공업지주 2873204 14.47 77.23
## 4    G10 WICS 에너지    19850082 078930                 GS 2491805 12.55 89.78
## 5    G10 WICS 에너지    19850082 067630 에이치엘비생명과학  624986  3.15 92.93
## 6    G10 WICS 에너지    19850082 006120       SK디스커버리  257059  1.30 94.22
##   CAL_WGT SEC_CD SEC_NM_KOR SEQ TOP60 APT_SHR_CNT
## 1       1    G10     에너지   1     2    56403994
## 2       1    G10     에너지   2     2    41655633
## 3       1    G10     에너지   3     2     9283372
## 4       1    G10     에너지   4     2    49245150
## 5       1    G10     에너지   5     2    39307272
## 6       1    G10     에너지   6     2    10470820
## 
## $sector
##   SEC_CD         SEC_NM_KOR SEC_RATE IDX_RATE
## 1    G25     경기관련소비재    16.05        0
## 2    G35           건강관리     9.27        0
## 3    G50 커뮤니케이션서비스     2.26        0
## 4    G40               금융    10.31        0
## 5    G10             에너지     2.37      100
## 6    G20             산업재    12.68        0
## 
## $size
##   SEC_CD    SEC_NM_KOR SEC_RATE IDX_RATE
## 1 WMI510 WMI500 대형주    69.40    89.78
## 2 WMI520 WMI500 중형주    13.56     4.44
## 3 WMI530 WMI500 소형주    17.04     5.78</code></pre>
<p>$list 항목에는 해당 섹터의 구성종목 정보가 있으며, $sector 항목을 통해 다른 섹터의 코드도 확인할 수 있습니다. for loop 구문을 이용해 URL의 sec_cd=에 해당하는 부분만 변경하면 모든 섹터의 구성종목을 매우 쉽게 얻을 수 있습니다.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="금융-데이터-수집하기-기본.html#cb444-1" aria-hidden="true" tabindex="-1"></a>sector_code <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;G25&#39;</span>, <span class="st">&#39;G35&#39;</span>, <span class="st">&#39;G50&#39;</span>, <span class="st">&#39;G40&#39;</span>, <span class="st">&#39;G10&#39;</span>,</span>
<span id="cb444-2"><a href="금융-데이터-수집하기-기본.html#cb444-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;G20&#39;</span>, <span class="st">&#39;G55&#39;</span>, <span class="st">&#39;G30&#39;</span>, <span class="st">&#39;G15&#39;</span>, <span class="st">&#39;G45&#39;</span>)</span>
<span id="cb444-3"><a href="금융-데이터-수집하기-기본.html#cb444-3" aria-hidden="true" tabindex="-1"></a>data_sector <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb444-4"><a href="금융-데이터-수집하기-기본.html#cb444-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-5"><a href="금융-데이터-수집하기-기본.html#cb444-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> sector_code) {</span>
<span id="cb444-6"><a href="금융-데이터-수집하기-기본.html#cb444-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb444-7"><a href="금융-데이터-수집하기-기본.html#cb444-7" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">=</span> <span class="fu">paste0</span>(</span>
<span id="cb444-8"><a href="금융-데이터-수집하기-기본.html#cb444-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;http://www.wiseindex.com/Index/GetIndexComponets&#39;</span>,</span>
<span id="cb444-9"><a href="금융-데이터-수집하기-기본.html#cb444-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;?ceil_yn=0&amp;dt=&#39;</span>,biz_day,<span class="st">&#39;&amp;sec_cd=&#39;</span>,i)</span>
<span id="cb444-10"><a href="금융-데이터-수집하기-기본.html#cb444-10" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">fromJSON</span>(url)</span>
<span id="cb444-11"><a href="금융-데이터-수집하기-기본.html#cb444-11" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> data<span class="sc">$</span>list</span>
<span id="cb444-12"><a href="금융-데이터-수집하기-기본.html#cb444-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb444-13"><a href="금융-데이터-수집하기-기본.html#cb444-13" aria-hidden="true" tabindex="-1"></a>  data_sector[[i]] <span class="ot">=</span> data</span>
<span id="cb444-14"><a href="금융-데이터-수집하기-기본.html#cb444-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb444-15"><a href="금융-데이터-수집하기-기본.html#cb444-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb444-16"><a href="금융-데이터-수집하기-기본.html#cb444-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb444-17"><a href="금융-데이터-수집하기-기본.html#cb444-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-18"><a href="금융-데이터-수집하기-기본.html#cb444-18" aria-hidden="true" tabindex="-1"></a>data_sector <span class="ot">=</span> <span class="fu">do.call</span>(rbind, data_sector)</span></code></pre></div>
<p>해당 데이터를 csv 파일로 저장해주도록 합니다.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="금융-데이터-수집하기-기본.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_sector, <span class="st">&#39;data/KOR_sector.csv&#39;</span>)</span></code></pre></div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>특정한 규칙을 가진 문자열의 집합을 표현하는데 사용하는 형식 언어<a href="금융-데이터-수집하기-기본.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p><a href="https://en.wikipedia.org/wiki/Global_Industry_Classification_Standard" class="uri">https://en.wikipedia.org/wiki/Global_Industry_Classification_Standard</a><a href="금융-데이터-수집하기-기본.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p><a href="http://www.wiseindex.com/" class="uri">http://www.wiseindex.com/</a><a href="금융-데이터-수집하기-기본.html#fnref13" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<div id="disqus_thread"></div>
<script>

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://quant-cookbook.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
            </section>

          </div>
        </div>
      </div>
<a href="크롤링-이해하기.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="금융-데이터-수집하기-심화.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
},
"split_bib": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
